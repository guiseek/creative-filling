var Xr=Object.defineProperty;var Qr=(t,e,r)=>e in t?Xr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var M=(t,e,r)=>Qr(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function r(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(s){if(s.ep)return;s.ep=!0;const c=r(s);fetch(s.href,c)}})();const nr=t=>Object.values(t),sr=t=>new Promise(t),Jr=t=>Promise.all(t),Kr=async(t,e)=>{const r=e.map(String).map(i=>{const s=`url(./fonts/${t}-${i}.woff2)`;return new FontFace(t,s,{weight:i,style:"normal"}).load()});return(await Jr(r)).map(i=>document.fonts.add(i))},ir=t=>sr((e,r)=>{const i=new FileReader;i.addEventListener("error",()=>{const s="Error on load image of type";r(new DOMException(`${s}: ${t.type}`))}),i.addEventListener("loadend",()=>{typeof i.result=="string"&&e(i.result)}),i.readAsDataURL(t)}),en=(t,e)=>t/e*100;class A{constructor(e=0,r=0){M(this,"isCollision",e=>{const r=e,i=new A(r.x,r.y),s=new A(e.w,e.h),c=i.add(s);return this.x>=r.x&&this.y>=r.y&&this.x<=c.x&&this.y<=c.y});this.x=e,this.y=r}set(e,r){this.x=e,this.y=r}clone(){return new A(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}sub(e){return this.x-=e.x,this.y-=e.y,this}}const tn=t=>Object.fromEntries(new FormData(t).entries()),rn=t=>sr((e,r)=>{const i=t.slice(0,4),s=new FileReader;s.addEventListener("error",()=>{const c="Error on load file of type";r(new DOMException(`${c}: ${t.type}`))}),s.addEventListener("load",()=>{if(s.result instanceof ArrayBuffer)switch(new DataView(s.result).getUint32(0,!1)){case 2303741511:return e("image/png");case 1014199911:return e("image/svg+xml");case 4292411360:return e("image/jpeg");case 1195984440:return e("image/gif");case 1380533830:return e("image/webp");case 626017350:return e("application/pdf");case 1347093252:return e("application/zip");default:return e(null)}}),s.readAsArrayBuffer(i)}),ie=t=>{if(typeof t=="boolean")return"boolean";if(typeof t=="number")return"number";if(typeof t=="string"){if(!isNaN(Number(t))&&t.trim()!=="")return"number";const e=new Date(t);return!isNaN(e.getTime())&&/^\d{1,2}\/\d{1,2}\/\d{4}$|^\d{4}-\d{2}-\d{2}$/.test(t)?"date":"string"}else{if(t instanceof Date&&!isNaN(t.getTime()))return"date";throw new Error("Unsupported type")}},ae={number(t){return ie(t)==="number"},string(t){return ie(t)==="string"},boolean(t){return ie(t)==="boolean"},date(t){return ie(t)==="date"}},nn=t=>{let e=t;return ae.boolean(t)?t:ae.date(t)?(e=new Date(t.toString()),e):((ae.number(t)||ae.string(t))&&(e=t),e)},sn=t=>Object.entries(t),an=t=>Object.values(t),on=t=>{const e=t instanceof HTMLFormElement?tn(t):t;return sn(e).reduce((r,[i,s])=>({...r,[i]:nn(s)}),e)};function ar(t,e=1e3){let r=new Date().getTime(),i,s;return c=>{const f=new Date().getTime();i=c,f-r>=e?(r=f,t(c)):(clearTimeout(s),s=window.setTimeout(()=>{r=new Date().getTime(),t(i)},e-(f-r)))}}const Te=new Map,cn=(t,e)=>{const r=Ue(t);return Te.set(t,r.add(e)),()=>{r.delete(e),Te.set(t,r)}},Ue=t=>Te.get(t)??new Set,z=t=>e=>cn(t,e);class ln{constructor(e,r){M(this,"type");M(this,"value");this.type=e,this.value=r}}const $=t=>e=>new class extends ln{constructor(){super(t,e)}dispatch(){for(const r of Ue(this.type))r(this.value)}},D=t=>{for(const e of Ue(t.type))e(t.value)},ht=$("window.resize"),un=z("window.resize"),dn=$("canvas.update.size"),hn=z("canvas.update.size"),Ee=$("canvas.add.layer"),fn=z("canvas.add.layer"),pn=$("canvas.drag.over"),vn=z("canvas.drag.over"),gn=$("canvas.drag.leave"),mn=z("canvas.drag.leave"),yn=$("canvas.drop.image"),wn=z("canvas.drop.image"),v=(t,e)=>r=>{customElements.define(e,r,{extends:t})};var ft=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var pt;(function(t){(function(e){var r=typeof globalThis=="object"?globalThis:typeof ft=="object"?ft:typeof self=="object"?self:typeof this=="object"?this:R(),i=s(t);typeof r.Reflect<"u"&&(i=s(r.Reflect,i)),e(i,r),typeof r.Reflect>"u"&&(r.Reflect=t);function s(q,N){return function(B,J){Object.defineProperty(q,B,{configurable:!0,writable:!0,value:J}),N&&N(B,J)}}function c(){try{return Function("return this;")()}catch{}}function f(){try{return(0,eval)("(function() { return this; })()")}catch{}}function R(){return c()||f()}})(function(e,r){var i=Object.prototype.hasOwnProperty,s=typeof Symbol=="function",c=s&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",f=s&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",R=typeof Object.create=="function",q={__proto__:[]}instanceof Array,N=!R&&!q,B={create:R?function(){return be(Object.create(null))}:q?function(){return be({__proto__:null})}:function(){return be({})},has:N?function(n,a){return i.call(n,a)}:function(n,a){return a in n},get:N?function(n,a){return i.call(n,a)?n[a]:void 0}:function(n,a){return n[a]}},J=Object.getPrototypeOf(Function),K=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ur(),ve=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Gr(),ge=typeof WeakMap=="function"?WeakMap:Nr(),Y=s?Symbol.for("@reflect-metadata:registry"):void 0,ne=Wr(),Ve=qr(ne);function Or(n,a,o,l){if(b(o)){if(!st(n))throw new TypeError;if(!it(a))throw new TypeError;return zr(n,a)}else{if(!st(n))throw new TypeError;if(!C(a))throw new TypeError;if(!C(l)&&!b(l)&&!V(l))throw new TypeError;return V(l)&&(l=void 0),o=F(o),$r(n,a,o,l)}}e("decorate",Or);function Tr(n,a){function o(l,g){if(!C(l))throw new TypeError;if(!b(g)&&!Zr(g))throw new TypeError;Ke(n,a,l,g)}return o}e("metadata",Tr);function Er(n,a,o,l){if(!C(o))throw new TypeError;return b(l)||(l=F(l)),Ke(n,a,o,l)}e("defineMetadata",Er);function Lr(n,a,o){if(!C(a))throw new TypeError;return b(o)||(o=F(o)),Xe(n,a,o)}e("hasMetadata",Lr);function Cr(n,a,o){if(!C(a))throw new TypeError;return b(o)||(o=F(o)),me(n,a,o)}e("hasOwnMetadata",Cr);function Hr(n,a,o){if(!C(a))throw new TypeError;return b(o)||(o=F(o)),Qe(n,a,o)}e("getMetadata",Hr);function Dr(n,a,o){if(!C(a))throw new TypeError;return b(o)||(o=F(o)),Je(n,a,o)}e("getOwnMetadata",Dr);function Sr(n,a){if(!C(n))throw new TypeError;return b(a)||(a=F(a)),et(n,a)}e("getMetadataKeys",Sr);function Pr(n,a){if(!C(n))throw new TypeError;return b(a)||(a=F(a)),tt(n,a)}e("getOwnMetadataKeys",Pr);function jr(n,a,o){if(!C(a))throw new TypeError;if(b(o)||(o=F(o)),!C(a))throw new TypeError;b(o)||(o=F(o));var l=ee(a,o,!1);return b(l)?!1:l.OrdinaryDeleteMetadata(n,a,o)}e("deleteMetadata",jr);function zr(n,a){for(var o=n.length-1;o>=0;--o){var l=n[o],g=l(a);if(!b(g)&&!V(g)){if(!it(g))throw new TypeError;a=g}}return a}function $r(n,a,o,l){for(var g=n.length-1;g>=0;--g){var S=n[g],H=S(a,o,l);if(!b(H)&&!V(H)){if(!C(H))throw new TypeError;l=H}}return l}function Xe(n,a,o){var l=me(n,a,o);if(l)return!0;var g=we(a);return V(g)?!1:Xe(n,g,o)}function me(n,a,o){var l=ee(a,o,!1);return b(l)?!1:nt(l.OrdinaryHasOwnMetadata(n,a,o))}function Qe(n,a,o){var l=me(n,a,o);if(l)return Je(n,a,o);var g=we(a);if(!V(g))return Qe(n,g,o)}function Je(n,a,o){var l=ee(a,o,!1);if(!b(l))return l.OrdinaryGetOwnMetadata(n,a,o)}function Ke(n,a,o,l){var g=ee(o,l,!0);g.OrdinaryDefineOwnMetadata(n,a,o,l)}function et(n,a){var o=tt(n,a),l=we(n);if(l===null)return o;var g=et(l,a);if(g.length<=0)return o;if(o.length<=0)return g;for(var S=new ve,H=[],_=0,u=o;_<u.length;_++){var d=u[_],h=S.has(d);h||(S.add(d),H.push(d))}for(var p=0,x=g;p<x.length;p++){var d=x[p],h=S.has(d);h||(S.add(d),H.push(d))}return H}function tt(n,a){var o=ee(n,a,!1);return o?o.OrdinaryOwnMetadataKeys(n,a):[]}function rt(n){if(n===null)return 1;switch(typeof n){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return n===null?1:6;default:return 6}}function b(n){return n===void 0}function V(n){return n===null}function kr(n){return typeof n=="symbol"}function C(n){return typeof n=="object"?n!==null:typeof n=="function"}function Rr(n,a){switch(rt(n)){case 0:return n;case 1:return n;case 2:return n;case 3:return n;case 4:return n;case 5:return n}var o="string",l=at(n,c);if(l!==void 0){var g=l.call(n,o);if(C(g))throw new TypeError;return g}return Ir(n)}function Ir(n,a){var o,l;{var g=n.toString;if(se(g)){var l=g.call(n);if(!C(l))return l}var o=n.valueOf;if(se(o)){var l=o.call(n);if(!C(l))return l}}throw new TypeError}function nt(n){return!!n}function Fr(n){return""+n}function F(n){var a=Rr(n);return kr(a)?a:Fr(a)}function st(n){return Array.isArray?Array.isArray(n):n instanceof Object?n instanceof Array:Object.prototype.toString.call(n)==="[object Array]"}function se(n){return typeof n=="function"}function it(n){return typeof n=="function"}function Zr(n){switch(rt(n)){case 3:return!0;case 4:return!0;default:return!1}}function ye(n,a){return n===a||n!==n&&a!==a}function at(n,a){var o=n[a];if(o!=null){if(!se(o))throw new TypeError;return o}}function ot(n){var a=at(n,f);if(!se(a))throw new TypeError;var o=a.call(n);if(!C(o))throw new TypeError;return o}function ct(n){return n.value}function lt(n){var a=n.next();return a.done?!1:a}function ut(n){var a=n.return;a&&a.call(n)}function we(n){var a=Object.getPrototypeOf(n);if(typeof n!="function"||n===J||a!==J)return a;var o=n.prototype,l=o&&Object.getPrototypeOf(o);if(l==null||l===Object.prototype)return a;var g=l.constructor;return typeof g!="function"||g===n?a:g}function Ar(){var n;!b(Y)&&typeof r.Reflect<"u"&&!(Y in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(n=Br(r.Reflect));var a,o,l,g=new ge,S={registerProvider:H,getProvider:u,setProvider:h};return S;function H(p){if(!Object.isExtensible(S))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case n===p:break;case b(a):a=p;break;case a===p:break;case b(o):o=p;break;case o===p:break;default:l===void 0&&(l=new ve),l.add(p);break}}function _(p,x){if(!b(a)){if(a.isProviderFor(p,x))return a;if(!b(o)){if(o.isProviderFor(p,x))return a;if(!b(l))for(var T=ot(l);;){var E=lt(T);if(!E)return;var I=ct(E);if(I.isProviderFor(p,x))return ut(T),I}}}if(!b(n)&&n.isProviderFor(p,x))return n}function u(p,x){var T=g.get(p),E;return b(T)||(E=T.get(x)),b(E)&&(E=_(p,x),b(E)||(b(T)&&(T=new K,g.set(p,T)),T.set(x,E))),E}function d(p){if(b(p))throw new TypeError;return a===p||o===p||!b(l)&&l.has(p)}function h(p,x,T){if(!d(T))throw new Error("Metadata provider not registered.");var E=u(p,x);if(E!==T){if(!b(E))return!1;var I=g.get(p);b(I)&&(I=new K,g.set(p,I)),I.set(x,T)}return!0}}function Wr(){var n;return!b(Y)&&C(r.Reflect)&&Object.isExtensible(r.Reflect)&&(n=r.Reflect[Y]),b(n)&&(n=Ar()),!b(Y)&&C(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,Y,{enumerable:!1,configurable:!1,writable:!1,value:n}),n}function qr(n){var a=new ge,o={isProviderFor:function(d,h){var p=a.get(d);return b(p)?!1:p.has(h)},OrdinaryDefineOwnMetadata:H,OrdinaryHasOwnMetadata:g,OrdinaryGetOwnMetadata:S,OrdinaryOwnMetadataKeys:_,OrdinaryDeleteMetadata:u};return ne.registerProvider(o),o;function l(d,h,p){var x=a.get(d),T=!1;if(b(x)){if(!p)return;x=new K,a.set(d,x),T=!0}var E=x.get(h);if(b(E)){if(!p)return;if(E=new K,x.set(h,E),!n.setProvider(d,h,o))throw x.delete(h),T&&a.delete(d),new Error("Wrong provider for target.")}return E}function g(d,h,p){var x=l(h,p,!1);return b(x)?!1:nt(x.has(d))}function S(d,h,p){var x=l(h,p,!1);if(!b(x))return x.get(d)}function H(d,h,p,x){var T=l(p,x,!0);T.set(d,h)}function _(d,h){var p=[],x=l(d,h,!1);if(b(x))return p;for(var T=x.keys(),E=ot(T),I=0;;){var dt=lt(E);if(!dt)return p.length=I,p;var Yr=ct(dt);try{p[I]=Yr}catch(Vr){try{ut(E)}finally{throw Vr}}I++}}function u(d,h,p){var x=l(h,p,!1);if(b(x)||!x.delete(d))return!1;if(x.size===0){var T=a.get(h);b(T)||(T.delete(p),T.size===0&&a.delete(T))}return!0}}function Br(n){var a=n.defineMetadata,o=n.hasOwnMetadata,l=n.getOwnMetadata,g=n.getOwnMetadataKeys,S=n.deleteMetadata,H=new ge,_={isProviderFor:function(u,d){var h=H.get(u);return!b(h)&&h.has(d)?!0:g(u,d).length?(b(h)&&(h=new ve,H.set(u,h)),h.add(d),!0):!1},OrdinaryDefineOwnMetadata:a,OrdinaryHasOwnMetadata:o,OrdinaryGetOwnMetadata:l,OrdinaryOwnMetadataKeys:g,OrdinaryDeleteMetadata:S};return _}function ee(n,a,o){var l=ne.getProvider(n,a);if(!b(l))return l;if(o){if(ne.setProvider(n,a,Ve))return Ve;throw new Error("Illegal state.")}}function Ur(){var n={},a=[],o=function(){function _(u,d,h){this._index=0,this._keys=u,this._values=d,this._selector=h}return _.prototype["@@iterator"]=function(){return this},_.prototype[f]=function(){return this},_.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var d=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=a,this._values=a):this._index++,{value:d,done:!1}}return{value:void 0,done:!0}},_.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=a,this._values=a),u},_.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=a,this._values=a),{value:u,done:!0}},_}(),l=function(){function _(){this._keys=[],this._values=[],this._cacheKey=n,this._cacheIndex=-2}return Object.defineProperty(_.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),_.prototype.has=function(u){return this._find(u,!1)>=0},_.prototype.get=function(u){var d=this._find(u,!1);return d>=0?this._values[d]:void 0},_.prototype.set=function(u,d){var h=this._find(u,!0);return this._values[h]=d,this},_.prototype.delete=function(u){var d=this._find(u,!1);if(d>=0){for(var h=this._keys.length,p=d+1;p<h;p++)this._keys[p-1]=this._keys[p],this._values[p-1]=this._values[p];return this._keys.length--,this._values.length--,ye(u,this._cacheKey)&&(this._cacheKey=n,this._cacheIndex=-2),!0}return!1},_.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=n,this._cacheIndex=-2},_.prototype.keys=function(){return new o(this._keys,this._values,g)},_.prototype.values=function(){return new o(this._keys,this._values,S)},_.prototype.entries=function(){return new o(this._keys,this._values,H)},_.prototype["@@iterator"]=function(){return this.entries()},_.prototype[f]=function(){return this.entries()},_.prototype._find=function(u,d){if(!ye(this._cacheKey,u)){this._cacheIndex=-1;for(var h=0;h<this._keys.length;h++)if(ye(this._keys[h],u)){this._cacheIndex=h;break}}return this._cacheIndex<0&&d&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},_}();return l;function g(_,u){return _}function S(_,u){return u}function H(_,u){return[_,u]}}function Gr(){var n=function(){function a(){this._map=new K}return Object.defineProperty(a.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),a.prototype.has=function(o){return this._map.has(o)},a.prototype.add=function(o){return this._map.set(o,o),this},a.prototype.delete=function(o){return this._map.delete(o)},a.prototype.clear=function(){this._map.clear()},a.prototype.keys=function(){return this._map.keys()},a.prototype.values=function(){return this._map.keys()},a.prototype.entries=function(){return this._map.entries()},a.prototype["@@iterator"]=function(){return this.keys()},a.prototype[f]=function(){return this.keys()},a}();return n}function Nr(){var n=16,a=B.create(),o=l();return function(){function u(){this._key=l()}return u.prototype.has=function(d){var h=g(d,!1);return h!==void 0?B.has(h,this._key):!1},u.prototype.get=function(d){var h=g(d,!1);return h!==void 0?B.get(h,this._key):void 0},u.prototype.set=function(d,h){var p=g(d,!0);return p[this._key]=h,this},u.prototype.delete=function(d){var h=g(d,!1);return h!==void 0?delete h[this._key]:!1},u.prototype.clear=function(){this._key=l()},u}();function l(){var u;do u="@@WeakMap@@"+_();while(B.has(a,u));return a[u]=!0,u}function g(u,d){if(!i.call(u,o)){if(!d)return;Object.defineProperty(u,o,{value:B.create()})}return u[o]}function S(u,d){for(var h=0;h<d;++h)u[h]=Math.random()*255|0;return u}function H(u){if(typeof Uint8Array=="function"){var d=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(d):typeof msCrypto<"u"?msCrypto.getRandomValues(d):S(d,u),d}return S(new Array(u),u)}function _(){var u=H(n);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var d="",h=0;h<n;++h){var p=u[h];(h===4||h===6||h===8)&&(d+="-"),p<16&&(d+="0"),d+=p.toString(16).toLowerCase()}return d}}function be(n){return n.__=void 0,delete n.__,n}})})(pt||(pt={}));function m(t,e){return Object.assign(t,e??{})}const bn=$("context.open"),_n=z("context.open"),xn=$("context.close"),Mn=z("context.close");Mn(({context:t,option:e})=>{e==="bring-to-front"&&P.bringLayerToFront(t.layer),e==="send-to-back"&&P.sendLayerToBack(t.layer),e==="remove"&&P.removeLayer(t.layer),P.setIsContextMenu(!1),t.close()});function y(t,e,r,i){var s=arguments.length,c=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(t,e,r,i);else for(var R=t.length-1;R>=0;R--)(f=t[R])&&(c=(s<3?f(c):s>3?f(e,r,c):f(e,r))||c);return s>3&&c&&Object.defineProperty(e,r,c),c}function w(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}let vt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};vt=y([v("address","web-address"),w("design:paramtypes",[Object])],vt);let gt=class extends HTMLAnchorElement{constructor(r={}){super();M(this,"target");M(this,"rel");m(this,r)}};gt=y([v("a","web-anchor"),w("design:paramtypes",[Object])],gt);let mt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};mt=y([v("article","web-article"),w("design:paramtypes",[Object])],mt);let yt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};yt=y([v("aside","web-aside"),w("design:paramtypes",[Object])],yt);let wt=class extends HTMLBRElement{constructor(e={}){super(),m(this,e)}};wt=y([v("br","web-break"),w("design:paramtypes",[Object])],wt);let Q=class extends HTMLButtonElement{constructor(e={}){super(),m(this,e)}};Q=y([v("button","web-button"),w("design:paramtypes",[Object])],Q);let bt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};bt=y([v("cite","web-cite"),w("design:paramtypes",[Object])],bt);let _t=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};_t=y([v("code","web-code"),w("design:paramtypes",[Object])],_t);let xt=class extends HTMLDataListElement{constructor(e={}){super(),m(this,e)}};xt=y([v("datalist","web-data-list"),w("design:paramtypes",[Object])],xt);let Mt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};Mt=y([v("dd","web-description-definition"),w("design:paramtypes",[Object])],Mt);let Ot=class extends HTMLDListElement{constructor(e={}){super(),m(this,e)}};Ot=y([v("dl","web-description-list"),w("design:paramtypes",[Object])],Ot);let Tt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};Tt=y([v("dt","web-description-term"),w("design:paramtypes",[Object])],Tt);let Et=class extends HTMLDivElement{constructor(e={}){super(),m(this,e)}};Et=y([v("div","web-div"),w("design:paramtypes",[Object])],Et);let Lt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};Lt=y([v("em","web-emphasis"),w("design:paramtypes",[Object])],Lt);let Ct=class extends HTMLFieldSetElement{constructor(e={}){super(),m(this,e)}};Ct=y([v("fieldset","web-fieldset"),w("design:paramtypes",[Object])],Ct);let Ht=class extends HTMLElement{};Ht=y([v("figcaption","web-figcaption")],Ht);let Dt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};Dt=y([v("figure","web-figure"),w("design:paramtypes",[Object])],Dt);let Le=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};Le=y([v("footer","web-footer"),w("design:paramtypes",[Object])],Le);let Ce=class extends HTMLFormElement{constructor(e={}){super(),m(this,e)}};Ce=y([v("form","web-form"),w("design:paramtypes",[Object])],Ce);let St=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};St=y([v("header","web-header"),w("design:paramtypes",[Object])],St);let Pt=class extends HTMLHeadingElement{constructor(e={}){super(),m(this,e)}};Pt=y([v("h1","web-h1"),w("design:paramtypes",[Object])],Pt);let jt=class extends HTMLHeadingElement{constructor(e={}){super(),m(this,e)}};jt=y([v("h2","web-h2"),w("design:paramtypes",[Object])],jt);let zt=class extends HTMLHeadingElement{constructor(e={}){super(),m(this,e)}};zt=y([v("h3","web-h3"),w("design:paramtypes",[Object])],zt);let $t=class extends HTMLHeadingElement{constructor(e={}){super(),m(this,e)}};$t=y([v("h4","web-h4"),w("design:paramtypes",[Object])],$t);let kt=class extends HTMLHeadingElement{constructor(e={}){super(),m(this,e)}};kt=y([v("h5","web-h5"),w("design:paramtypes",[Object])],kt);let Rt=class extends HTMLHeadingElement{constructor(e={}){super(),m(this,e)}};Rt=y([v("h6","web-h6"),w("design:paramtypes",[Object])],Rt);let He=class extends HTMLHRElement{constructor(e={}){super(),m(this,e)}};He=y([v("hr","web-horizontal-rule"),w("design:paramtypes",[Object])],He);let U=class extends HTMLInputElement{constructor(e={}){super(),m(this,e)}};U=y([v("input","web-input"),w("design:paramtypes",[Object])],U);let It=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};It=y([v("kbd","web-keyboard"),w("design:paramtypes",[Object])],It);let Ft=class extends HTMLLabelElement{constructor(e={}){super(),m(this,e)}};Ft=y([v("label","web-label"),w("design:paramtypes",[Object])],Ft);let Zt=class extends HTMLLIElement{constructor(e={}){super(),m(this,e)}};Zt=y([v("li","web-list-item"),w("design:paramtypes",[Object])],Zt);let At=class extends HTMLOListElement{constructor(e={}){super(),m(this,e)}};At=y([v("ol","web-ordered-list"),w("design:paramtypes",[Object])],At);let Wt=class extends HTMLUListElement{constructor(e={}){super(),m(this,e)}};Wt=y([v("ul","web-unordered-list"),w("design:paramtypes",[Object])],Wt);let qt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};qt=y([v("main","web-main"),w("design:paramtypes",[Object])],qt);let Bt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};Bt=y([v("mark","web-mark"),w("design:paramtypes",[Object])],Bt);let De=class extends HTMLMenuElement{constructor(e={}){super(),m(this,e)}};De=y([v("menu","web-menu"),w("design:paramtypes",[Object])],De);let Ut=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};Ut=y([v("nav","web-nav"),w("design:paramtypes",[Object])],Ut);let _e=class extends HTMLObjectElement{constructor(e={}){super(),m(this,e)}};_e=y([v("object","web-object"),w("design:paramtypes",[_e])],_e);let Gt=class extends HTMLParagraphElement{constructor(e={}){super(),m(this,e)}};Gt=y([v("p","web-paragraph"),w("design:paramtypes",[Object])],Gt);let Nt=class extends HTMLPreElement{constructor(e={}){super(),m(this,e)}};Nt=y([v("pre","web-preformatted"),w("design:paramtypes",[Object])],Nt);let Yt=class extends HTMLProgressElement{constructor(e={}){super(),m(this,e)}};Yt=y([v("progress","web-progress"),w("design:paramtypes",[Object])],Yt);let Vt=class extends HTMLQuoteElement{constructor(e={}){super(),m(this,e)}};Vt=y([v("blockquote","web-blockquote"),w("design:paramtypes",[Object])],Vt);let Xt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};Xt=y([v("section","web-section"),w("design:paramtypes",[Object])],Xt);let Qt=class extends HTMLSelectElement{constructor(e={}){super(),m(this,e)}};Qt=y([v("select","web-select"),w("design:paramtypes",[Object])],Qt);let Jt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};Jt=y([v("small","web-small"),w("design:paramtypes",[Object])],Jt);let fe=class extends HTMLSpanElement{constructor(e={}){super(),m(this,e)}};fe=y([v("span","web-span"),w("design:paramtypes",[Object])],fe);let Kt=class extends HTMLElement{constructor(e={}){super(),m(this,e)}};Kt=y([v("strong","web-strong"),w("design:paramtypes",[Object])],Kt);let er=class extends HTMLTimeElement{constructor(e={}){super(),m(this,e)}};er=y([v("time","web-time"),w("design:paramtypes",[Object])],er);const G={empty:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"> </svg>',image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"> <path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm40-80h480L570-480 450-320l-90-120-120 160Zm-40 80v-560 560Z" /> </svg>',text:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"> <path d="M420-160v-520H200v-120h560v120H540v520H420Z"/> </svg>',edit:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"> <path d="M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"/> </svg>',delete:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"> <path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"/> </svg>',bringToFront:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"> <path d="M360-280q-33 0-56.5-23.5T280-360v-400q0-33 23.5-56.5T360-840h400q33 0 56.5 23.5T840-760v400q0 33-23.5 56.5T760-280H360Zm0-80h400v-400H360v400ZM200-200v80q-33 0-56.5-23.5T120-200h80Zm-80-80v-80h80v80h-80Zm0-160v-80h80v80h-80Zm0-160v-80h80v80h-80Zm160 480v-80h80v80h-80Zm160 0v-80h80v80h-80Zm160 0v-80h80v80h-80Z"/> </svg>',sendToBack:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"> <path d="M200-120q-33 0-56.5-23.5T120-200v-480h80v480h480v80H200Zm160-240v80q-33 0-56.5-23.5T280-360h80Zm-80-80v-80h80v80h-80Zm0-160v-80h80v80h-80Zm80-160h-80q0-33 23.5-56.5T360-840v80Zm80 480v-80h80v80h-80Zm0-480v-80h80v80h-80Zm160 0v-80h80v80h-80Zm0 480v-80h80v80h-80Zm160-480v-80q33 0 56.5 23.5T840-760h-80Zm0 400h80q0 33-23.5 56.5T760-280v-80Zm0-80v-80h80v80h-80Zm0-160v-80h80v80h-80Z"/> </svg>',fill:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"> <path d="m247-904 57-56 343 343q23 23 23 57t-23 57L457-313q-23 23-57 23t-57-23L153-503q-23-23-23-57t23-57l190-191-96-96Zm153 153L209-560h382L400-751Zm360 471q-33 0-56.5-23.5T680-360q0-21 12.5-45t27.5-45q9-12 19-25t21-25q11 12 21 25t19 25q15 21 27.5 45t12.5 45q0 33-23.5 56.5T760-280ZM80 0v-160h800V0H80Z"/> </svg>'};var On=Object.defineProperty,Tn=Object.getOwnPropertyDescriptor,En=(t,e,r,i)=>{for(var s=i>1?void 0:i?Tn(e,r):e,c=t.length-1,f;c>=0;c--)(f=t[c])&&(s=(i?f(e,r,s):f(s))||s);return i&&s&&On(e,r,s),s};let X=class extends Q{constructor(e,r,i){super(i);M(this,"elements",[]);this.context=e,this.options=r,this.innerHTML=r.icon??G.empty,this.elements.push(new fe({textContent:r.text})),r.shortcut&&this.elements.push(new fe({textContent:r.shortcut})),this.append(...this.elements)}connectedCallback(){this.addEventListener("click",()=>{D(xn({context:this.context,option:this.value}))})}};X=En([v("button","cf-context-button")],X);var Ln=Object.defineProperty,Cn=Object.getOwnPropertyDescriptor,or=t=>{throw TypeError(t)},Hn=(t,e,r,i)=>{for(var s=i>1?void 0:i?Cn(e,r):e,c=t.length-1,f;c>=0;c--)(f=t[c])&&(s=(i?f(e,r,s):f(s))||s);return i&&s&&Ln(e,r,s),s},Dn=(t,e,r)=>e.has(t)||or("Cannot "+r),Sn=(t,e,r)=>e.has(t)?or("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),tr=(t,e,r)=>(Dn(t,e,"access private method"),r),ce,Se;let Pe=class extends HTMLDialogElement{constructor(t={}){super(),Sn(this,ce),m(this,t),tr(this,ce,Se).call(this,"normal")}close(t){tr(this,ce,Se).call(this,"reverse").addEventListener("finish",()=>{this.close(t),this.remove()})}};ce=new WeakSet;Se=function(t){return this.animate([{transform:"translateY(1000px) scaleY(2.5) scaleX(0.2)",transformOrigin:"50% 100%",filter:"blur(40px)",opacity:"0"},{transform:"translateY(0) scaleY(1) scaleX(1)",transformOrigin:"50% 50%",filter:"blur(0)",opacity:"1"}],{direction:t,duration:600,easing:"cubic-bezier(0.23, 1, 0.32, 1)"})};Pe=Hn([v("dialog","web-dialog")],Pe);var Pn=Object.defineProperty,jn=Object.getOwnPropertyDescriptor,cr=t=>{throw TypeError(t)},zn=(t,e,r,i)=>{for(var s=i>1?void 0:i?jn(e,r):e,c=t.length-1,f;c>=0;c--)(f=t[c])&&(s=(i?f(e,r,s):f(s))||s);return i&&s&&Pn(e,r,s),s},lr=(t,e,r)=>e.has(t)||cr("Cannot "+r),$n=(t,e,r)=>(lr(t,e,"read from private field"),r?r.call(t):e.get(t)),kn=(t,e,r)=>e.has(t)?cr("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Rn=(t,e,r,i)=>(lr(t,e,"write to private field"),e.set(t,r),r),le;let je=class extends HTMLDivElement{constructor(t){super(),this.id=t,kn(this,le,!0)}set hidden(t){Rn(this,le,t),this.style.display=t?"none":"block"}get hidden(){return $n(this,le)}toggle(){this.style.display=this.hidden?"block":"none"}};le=new WeakMap;je=zn([v("div","cf-overlay")],je);const In=t=>{const e=new je(t);return document.body.insertAdjacentElement("beforeend",e),new MutationObserver(()=>{e.hidden=e.childElementCount<1}).observe(e,{childList:!0}),e};var Fn=Object.defineProperty,Zn=Object.getOwnPropertyDescriptor,ur=t=>{throw TypeError(t)},An=(t,e,r,i)=>{for(var s=i>1?void 0:i?Zn(e,r):e,c=t.length-1,f;c>=0;c--)(f=t[c])&&(s=(i?f(e,r,s):f(s))||s);return i&&s&&Fn(e,r,s),s},dr=(t,e,r)=>e.has(t)||ur("Cannot "+r),xe=(t,e,r)=>(dr(t,e,"read from private field"),r?r.call(t):e.get(t)),rr=(t,e,r)=>e.has(t)?ur("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Wn=(t,e,r,i)=>(dr(t,e,"write to private field"),e.set(t,r),r),ze,te;let $e=class extends De{constructor(t,e){super(e),this.layer=t,rr(this,ze,[]),rr(this,te),Wn(this,te,In("cf-context-overlay"))}connectedCallback(){this.classList.add("cf-context")}addButton(t){xe(this,ze).push(t),this.append(t)}addDivider(){this.append(new He)}open({x:t,y:e}){this.style.top=`${e}px`,this.style.left=`${t}px`,this.style.display="flex",xe(this,te).append(this),document.addEventListener("click",r=>{const i=r.target;this.contains(i)||this.close()})}close(){this.style.display="none",xe(this,te).remove()}};ze=new WeakMap;te=new WeakMap;$e=An([v("menu","cf-context")],$e);_n(({layer:t,position:e})=>{const r=new $e(t);t.type==="text"&&(r.addButton(new X(r,{icon:G.edit,text:"Editar"},{value:"edit"})),r.addDivider());const i=P.layers.map(s=>s.order);r.addButton(new X(r,{icon:G.bringToFront,text:"Trazer para frente"},{disabled:t.order===Math.max(...i),value:"bring-to-front"})),r.addButton(new X(r,{icon:G.sendToBack,text:"Enviar para trás"},{disabled:t.order===Math.min(...i),value:"send-to-back"})),r.addDivider(),r.addButton(new X(r,{icon:G.delete,text:"Remover",shortcut:"Cmd+Del"},{value:"remove"})),r.open(e)});var hr=Object.defineProperty,qn=Object.getOwnPropertyDescriptor,fr=t=>{throw TypeError(t)},Bn=(t,e,r)=>e in t?hr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Un=(t,e,r,i)=>{for(var s=i>1?void 0:i?qn(e,r):e,c=t.length-1,f;c>=0;c--)(f=t[c])&&(s=(i?f(e,r,s):f(s))||s);return i&&s&&hr(e,r,s),s},Me=(t,e,r)=>Bn(t,typeof e!="symbol"?e+"":e,r),Ge=(t,e,r)=>e.has(t)||fr("Cannot "+r),O=(t,e,r)=>(Ge(t,e,"read from private field"),r?r.call(t):e.get(t)),W=(t,e,r)=>e.has(t)?fr("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),oe=(t,e,r,i)=>(Ge(t,e,"write to private field"),e.set(t,r),r),k=(t,e,r)=>(Ge(t,e,"access private method"),r),Z,L,ue,de,ke,Re,Ie,Fe,j,Ze,Ae,Ne,pr,vr,gr,mr,yr,wr,Ye;let We=class extends HTMLCanvasElement{constructor(){super(),W(this,j),Me(this,"context"),Me(this,"offscreenCanvas"),Me(this,"offscreenContext"),W(this,Z,[]),W(this,L,null),W(this,ue,!1),W(this,de,""),W(this,ke,t=>{this.setIsContextMenu(!0),t.preventDefault();const{offsetX:e,offsetY:r}=t,i=new A(e,r),s=k(this,j,Ze).call(this,i);if(s.length>0){const c=k(this,j,Ae).call(this,s),f={x:t.pageX,y:t.pageY};D(bn({layer:c,position:f}))}}),W(this,Re,({offsetX:t,offsetY:e})=>{setTimeout(()=>{if(O(this,ue))return;const r=new A(t,e),i=k(this,j,Ze).call(this,r);if(i.length>0){const s=k(this,j,Ae).call(this,i),c=k(this,j,Ne).call(this,s,r);oe(this,L,s),c.x||c.y?s.startResize(c):s.startDrag(r)}})}),W(this,Ie,t=>{const{offsetX:e,offsetY:r}=t,i=new A(e,r);O(this,L)?k(this,j,pr).call(this,i):k(this,j,vr).call(this,i),this.render()}),W(this,Fe,()=>{O(this,L)&&(O(this,L).resizing?O(this,L).stopResize():O(this,L).stopDrag(),oe(this,L,null),this.render()),this.setIsContextMenu(!1)}),this.context=this.getContext("2d"),this.offscreenCanvas=new OffscreenCanvas(this.width,this.height),this.offscreenContext=this.offscreenCanvas.getContext("2d")}get layers(){return O(this,Z)}get fill(){return O(this,de)}setFill(t){oe(this,de,t)}addLayer(t){O(this,Z).push(t),t.setOrder(O(this,Z).length)}removeLayer(t){const e=O(this,Z).findIndex(r=>r.id===t.id);O(this,Z).splice(e,1),this.render().then()}connectedCallback(){this.oncontextmenu=O(this,ke),this.onmousedown=O(this,Re),this.onmousemove=ar(O(this,Ie),50),this.onmouseup=O(this,Fe)}async render(){if(!this.offscreenContext||!this.context)return;this.offscreenContext.clearRect(0,0,this.width,this.height),this.fill&&(this.offscreenContext.fillStyle=this.fill,this.offscreenContext.fillRect(0,0,this.width,this.height));const t=O(this,Z).filter(e=>e.active).sort((e,r)=>e.order-r.order);for(const e of t)await e.render(),k(this,j,gr).call(this,e,this.offscreenContext);O(this,L)&&O(this,L).resizing&&k(this,j,yr).call(this,O(this,L),this.offscreenContext),O(this,L)&&O(this,L).dragging&&k(this,j,wr).call(this,O(this,L),this.offscreenContext),this.context.clearRect(0,0,this.width,this.height),this.context.drawImage(this.offscreenCanvas,0,0)}setSize(t){this.width=t,this.height=t,this.offscreenCanvas.width=t,this.offscreenCanvas.height=t}setIsContextMenu(t){oe(this,ue,t)}bringLayerToFront(t){const e=t.order+1;if(this.layers.map(i=>i.order).includes(e))for(const i of this.layers)i.order<=e&&i.setOrder(i.order-1);t.setOrder(e),this.render().then()}sendLayerToBack(t){const e=t.order-1;if(this.layers.map(i=>i.order).includes(e))for(const i of this.layers)i.order>=e&&i.setOrder(i.order+1);t.setOrder(e),this.render().then()}};Z=new WeakMap;L=new WeakMap;ue=new WeakMap;de=new WeakMap;ke=new WeakMap;Re=new WeakMap;Ie=new WeakMap;Fe=new WeakMap;j=new WeakSet;Ze=function(t){return O(this,Z).filter(e=>t.isCollision(e.rect))};Ae=function(t){return t.reduce((e,r)=>r.order>e.order?r:e)};Ne=function(t,e){const i=t.rect;return{x:e.x>=i.x+i.w-10,y:e.y>=i.y+i.h-10}};pr=function(t){O(this,L)&&(O(this,L).resizing?O(this,L).resizeTo(t):O(this,L).dragging&&O(this,L).dragTo(t))};vr=function(t){let e="default";for(const r of O(this,Z))if(r.resizable&&t.isCollision(r.rect)){const i=k(this,j,Ne).call(this,r,t);(i.x||i.y)&&(e=i.x&&i.y?"nwse-resize":i.x?"ew-resize":"ns-resize"),r.setHovered(!0)}else r.setHovered(!1);this.style.cursor=e};gr=function(t,e){const{width:r,height:i}=t,{x:s,y:c}=t.position;e.drawImage(t,s,c,r,i),t.hovered&&k(this,j,mr).call(this,s,c,r,i,e)};mr=function(t,e,r,i,s){const c=new Path2D;c.rect(t,e,r,i),s.lineWidth=2,s.save(),s.filter="invert(100%)",s.strokeStyle="rgba(0,0,0, 0.4)",s.globalCompositeOperation="difference",s.stroke(c),s.restore()};yr=function(t,e){const{width:r,height:i}=t,{x:s,y:c}=t.position,f=`width: ${r}px - height: ${i}px`,R=e.measureText(f),q=s+r-R.width-5,N=c+i-5;k(this,j,Ye).call(this,e,f,q,N)};wr=function(t,e){const{x:r,y:i}=t.position,s=`x: ${r}px - y: ${i}px`,c=r+5,f=i+15;k(this,j,Ye).call(this,e,s,c,f)};Ye=function(t,e,r,i){t.font='12px "Segoe UI", sans-serif',t.save(),t.filter="invert(100%)",t.fillStyle="rgba(0,0,0, 0.8)",t.globalCompositeOperation="difference",t.fillText(e,r,i),t.restore()};We=Un([v("canvas","cf-canvas")],We);const P=new We;fn(t=>{P.addLayer(t),P.render().then()});mn(t=>{t.preventDefault(),P.style.border="0.2em solid rgb(var(--cf-onsurface-rgb))"});vn(t=>{t.preventDefault(),P.style.border="0.2em solid lime"});const br=$("layer.create.image"),Gn=z("layer.create.image"),Nn=$("layer.create.text"),Yn=z("layer.create.text");class _r extends OffscreenCanvas{constructor(r,i,s=0,c=0){super(r,i);M(this,"context");M(this,"_id");M(this,"_position",new A);M(this,"_offset",new A);M(this,"_parent");M(this,"_draggable",!0);M(this,"_resizable",!0);M(this,"_dragging",!1);M(this,"_resizing",!1);M(this,"_aspectRatio");M(this,"_resizeDirection",{x:!1,y:!1});M(this,"_hovered",!1);M(this,"_active",!0);M(this,"_order",0);this._position=new A(s,c),this.context=this.getContext("2d"),this._aspectRatio=r/i,this._id=crypto.randomUUID()}get id(){return this._id}get position(){return this._position}get dragging(){return this._dragging}get draggable(){return this._draggable}get resizing(){return this._resizing}get resizable(){return this._resizable}get hovered(){return this._hovered}get offset(){return this._offset}get active(){return this._active}get order(){return this._order}get rect(){return{x:this.position.x,y:this.position.y,w:this.width,h:this.height}}setActive(r){return this._active=r,this}setOrder(r){return this._order=r,this}setDraggable(r){return this._draggable=r,this}setDragging(r){return this._dragging=r,this}setHovered(r){return this._hovered=r,this}startDrag(r){this.setDragging(!0),this.offset.copy(r).sub(this.position)}dragTo(r){this.dragging&&this.position.copy(r).sub(this.offset)}stopDrag(){this.setDragging(!1)}setResizable(r){return this._resizable=r,this}setResizing(r){return this._resizing=r,this}startResize(r){this.setResizing(!0),this._resizeDirection=r}resizeTo(r){if(this._resizing){const{x:i,y:s}=this._resizeDirection;if(i&&s){const c=r.x-this.position.x,f=r.y-this.position.y,R=Math.max(c/this.width,f/this.height);this.width=this.width*R,this.height=this.height*R}else i?(this.width=Math.max(10,r.x-this.position.x),this.height=this.width/this._aspectRatio):s&&(this.height=Math.max(10,r.y-this.position.y),this.width=this.height*this._aspectRatio);this.render()}}stopResize(){this.setResizing(!1),this._resizeDirection={x:!1,y:!1}}}class Vn extends _r{constructor(){super(...arguments);M(this,"type","image");M(this,"image",new Image(this.width,this.height))}async render(){var s;if(!((s=this.context)!=null&&s.drawImage))return;this.context.clearRect(0,0,this.width,this.height),await this.image.decode();const{w:r,h:i}=this.rect;this.context.drawImage(this.image,0,0,r,i)}setSrc(r){return this.image.src=r,this}}Gn(t=>{const e=new Image;e.addEventListener("load",async()=>{const{width:r,height:i}=e,s=new Vn(r,i,0,0);s.image.src=t,await s.render(),D(Ee(s))}),e.src=t});class Xn extends _r{constructor(){super(...arguments);M(this,"type","text");M(this,"_text","");M(this,"_color","#111111");M(this,"_font","Mukta");M(this,"_size",3.2);M(this,"_weight","normal")}async render(){var i;if(!((i=this.context)!=null&&i.drawImage))return;this.context.clearRect(0,0,this.width,this.height),this.context.fillStyle=this._color,this.context.font=this.font;const r=this._size*10;this.context.fillText(this._text,0,r,this.width)}setText(r){return this._text=r,this}setColor(r){return this._color=r,this}setFont(r){return this._font=r,this}setSize(r){return this._size=r,this}setWeight(r){return this._weight=r,this}get font(){return`${this._weight} ${this._size}em ${this._font}`}}Yn(async({text:t,size:e,color:r,bold:i})=>{const s=new Xn(t.length*e*5,e*12,0,0);s.setText(t).setSize(e).setColor(r).setResizable(!1),i?(await s.setWeight("bold").render(),D(Ee(s))):(await s.render(),D(Ee(s)))});wn(t=>{var r;t.preventDefault(),P.style.border="0.2em solid rgb(var(--cf-onsurface-rgb))";const[e]=((r=t.dataTransfer)==null?void 0:r.files)??[];e&&rn(e).then(i=>{i&&i.startsWith("image/")&&ir(e).then(s=>{D(br(s))})})});hn(t=>{const e=Math.min(t.current.w,t.current.h),i=en(e,t.ideal)>100?t.ideal:e;P.setSize(i),P.render().then()});un(t=>{const e=t<1080?540:1080,{clientWidth:r,clientHeight:i}=root;D(dn({current:{w:r,h:i},ideal:e})),document.documentElement.style.setProperty("--cf-canvas-max-size",`${e}px`)});const Qn=$("form.text.submit"),Jn=z("form.text.submit"),Kn=$("form.fill.submit"),es=z("form.fill.submit");es(t=>{P.setFill(t.color),P.render().then()});Jn(async t=>{D(Nn(t))});var ts=Object.defineProperty,rs=Object.getOwnPropertyDescriptor,ns=(t,e,r,i)=>{for(var s=i>1?void 0:i?rs(e,r):e,c=t.length-1,f;c>=0;c--)(f=t[c])&&(s=(i?f(e,r,s):f(s))||s);return i&&s&&ts(e,r,s),s};let qe=class extends Ce{constructor(t,e={}){super(e),this.controls=t,this.append(...nr(this.controls))}get value(){return on(this)}};qe=ns([v("form","cf-form-group")],qe);var ss=Object.defineProperty,is=Object.getOwnPropertyDescriptor,as=(t,e,r,i)=>{for(var s=i>1?void 0:i?is(e,r):e,c=t.length-1,f;c>=0;c--)(f=t[c])&&(s=(i?f(e,r,s):f(s))||s);return i&&s&&ss(e,r,s),s};let pe=class extends Pe{constructor(e,r,i={}){super();M(this,"form");M(this,"actions");m(this,i),this.form=new qe(e,{onsubmit:c=>{c.preventDefault(),D(r(this.form.value)),this.close()}}),this.actions={confirm:new Q({type:"submit",textContent:"Confirm"}),cancel:new Q({type:"button",textContent:"Cancel",onclick:()=>{this.close("cancel")}})};const s=new Le;s.append(...an(this.actions)),this.form.append(s),this.append(this.form)}connectedCallback(){setTimeout(()=>{document.addEventListener("click",e=>{const r=e.target;this.form.contains(r)||this.close()})})}};pe=as([v("dialog","cf-form-dialog")],pe);const os=$("toolbar.selected"),cs=z("toolbar.selected"),ls=$("toolbar.select.image"),us=z("toolbar.select.image"),ds=$("toolbar.select.text"),hs=z("toolbar.select.text"),fs=$("toolbar.select.fill"),ps=z("toolbar.select.fill");ps(()=>{const e={color:new U({type:"color",name:"color",value:"#000000"})},r=new pe(e,Kn);document.body.insertAdjacentElement("beforeend",r),r.showModal()});us(()=>{const t=new U({type:"file",accept:"image/svg+xml,image/png",onchange(){const[e]=t.files??[];e&&ir(e).then(r=>{D(br(r))})}});t.click()});hs(()=>{const t=new U({type:"text",name:"text",placeholder:"Texto",required:!0}),e=new U({type:"number",name:"size",step:"0.1",value:"4.8"}),r=new U({type:"checkbox",name:"bold",value:"true",checked:!1}),i=new U({type:"color",name:"color",value:"#000000"}),s={text:t,size:e,color:i,bold:r},c=new pe(s,Qn);document.body.insertAdjacentElement("beforeend",c),c.showModal()});cs(t=>{switch(t){case"image":return D(ls());case"text":return D(ds());case"fill":return D(fs())}});var xr=Object.defineProperty,vs=Object.getOwnPropertyDescriptor,Mr=t=>{throw TypeError(t)},gs=(t,e,r)=>e in t?xr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ms=(t,e,r,i)=>{for(var s=i>1?void 0:i?vs(e,r):e,c=t.length-1,f;c>=0;c--)(f=t[c])&&(s=(i?f(e,r,s):f(s))||s);return i&&s&&xr(e,r,s),s},ys=(t,e,r)=>gs(t,e+"",r),ws=(t,e,r)=>e.has(t)||Mr("Cannot "+r),bs=(t,e,r)=>e.has(t)?Mr("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Oe=(t,e,r)=>(ws(t,e,"access private method"),r),re,he;let Be=class extends HTMLMenuElement{constructor(){super(...arguments),bs(this,re),ys(this,"buttons",{image:Oe(this,re,he).call(this,G.image,"image","Select image"),text:Oe(this,re,he).call(this,G.text,"text","Write text"),fill:Oe(this,re,he).call(this,G.fill,"fill","Format color fill")})}connectedCallback(){this.classList.add("cf-toolbar");for(const t of nr(this.buttons))this.append(t),t.addEventListener("click",()=>{const e=t.value;D(os(e))})}};re=new WeakSet;he=function(t,e,r){return new Q({innerHTML:t,value:e,title:r,type:"button"})};Be=ms([v("menu","cf-toolbar")],Be);const _s=()=>{const t=new Be,e=()=>Math.min(innerWidth,innerHeight);D(ht(e())),onresize=ar(()=>D(ht(e())),250),P.ondragover=r=>D(pn(r)),P.ondragleave=r=>D(gn(r)),P.ondrop=r=>D(yn(r)),root.append(t,P)};Kr("Mukta",[400,600,800]).then(_s);
